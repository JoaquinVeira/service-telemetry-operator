apiVersion: smartgateway.infra.watch/v2alpha1
kind: SmartGateway
metadata:
  name: '{{ meta.name }}-{{ agent.name|lower }}-telemetry'
  namespace: '{{ meta.namespace }}'
spec:
  amqpUrl: '{{ meta.name }}-interconnect.{{ meta.namespace }}.svc.cluster.local:5673/{{ agent.channel }}'
  amqpDataSource: '{{ agent.name|lower }}'
  debug: false
  serviceType: 'metrics'
  size: {% if agent.name == 'collectd' %} {{ smartgateway_deployment_size }} {% else %} 1 {% endif %}
  prefetch: 15000
  useTimestamp: true
